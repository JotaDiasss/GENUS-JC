{% extends 'layout.html' %}
{% load static %}

{% block title %}Configurações de Conta - Jornal{% endblock %}

{% block extra_css %}
    <link rel="stylesheet" href="{% static 'styles/configuracoes.css' %}">
{% endblock %}

{% block content %}
<main class="main-content">
    <section class="content-section">
        <div class="section-header">
            <h2 class="section-title">Configurações de Conta</h2>
        </div>

        <div class="config-card profile-info">
            <h3 class="card-title">Informações do Usuário</h3>
            <p class="user-display">
                Bem-vindo, <span class="username-highlight">{{ user.username }}</span>.
            </p>
        </div>

        <div class="config-card genre-preferences-card">
            
            {% if generos_salvos and not 'edit' in request.GET %}
                
                <div class="preferences-header">
                    <h3 class="card-title">Seus Gêneros Favoritos</h3>
                    <a href="?edit=true" class="edit-button">Alterar Preferências</a>
                </div>
                <div class="genre-container-display">
                    {% for genre in generos_salvos %}
                        <span class="genre-tag">{{ genre.nome }}</span>
                    {% endfor %}
                </div>

            {% else %}

                <form method="POST" action="{% url 'jornal:configuracoes_conta' %}">
                    {% csrf_token %}
                    <h3 class="card-title">Gêneros Favoritos</h3>
                    <p class="preference-instructions">Selecione os gêneros de notícias que você mais gosta.</p>
                    
                    <div class="genre-container-config">
                        {% for genre in all_genres %}
                            <div class="genre-item-config">
                                <input type="checkbox" name="genres" class="genre-checkbox" value="{{ genre.nome }}" id="pref-{{ genre.id }}"
                                    {% if genre in generos_salvos %}checked{% endif %}>
                                <label for="pref-{{ genre.id }}">{{ genre.nome }}</label>
                            </div>
                        {% endfor %}
                    </div>
                    <button type="submit" class="save-button" id="save-prefs-button">Salvar Preferências</button>
                </form>

            {% endif %}
        </div>
        
    </section>
</main>
{% endblock %}

{% block extra_scripts %}
    <script src="{% static 'scripts/configuracoes.js' %}"></script>
{% endblock %}