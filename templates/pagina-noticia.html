{% extends 'layout.html' %}
{% load static %}

{% block title %}{{ noticia.titulo }} | GENUS{% endblock %}

{% block extra_css %}
    <link rel="stylesheet" href="{% static 'styles/favoritos.css' %}">
{% endblock %}

{% block content %}
<article class="noticia-detalhe">
    <h1>{{ noticia.titulo }}</h1>

    <div class="noticia-meta">
        <span>Por: <strong>{{ noticia.reporter }}</strong></span>
        <span>Publicado em: {{ noticia.data|date:"d/m/Y \à\s H:i" }}</span>
    </div>

    <div class="corpo-noticia">
        {{ noticia.detalhes|linebreaks }}
    </div>

    {% if user.is_authenticated %}
        
        <button 
            id="btn-toggle-favorito"
            class="noticia-card-link btn-favorito {% if is_favorito %}favorito-ativo{% endif %}"
            data-noticia-id="{{ noticia.id }}"
            data-toggle-url="{% url 'jornal:toggle_favorito' noticia.id %}"
        >
            {% if is_favorito %}
                Remover dos Favoritos
            {% else %}
                Adicionar aos Favoritos
            {% endif %}
        </button>
        
    {% else %}
        <p>Faça login para adicionar aos favoritos.</p>
    {% endif %}
</article>

{% if noticias_relacionadas %}
<section class="noticias-relacionadas">
    <h2 class="titulo-principal" style="margin-top: 40px;">Notícias Relacionadas</h2>
    
    <div class="favoritos-grid"> 
        {% for rel_noticia in noticias_relacionadas %}
        <article class="noticia-card">
            <h2 class="noticia-card-titulo">
                <a href="{% url 'jornal:pagina_noticias' rel_noticia.slug %}">{{ rel_noticia.titulo }}</a>
            </h2>
            <p class="noticia-card-resumo">{{ rel_noticia.resumo }}</p>
            <a href="{% url 'jornal:pagina_noticias' rel_noticia.slug %}" class="noticia-card-link">Leia mais</a>
        </article>
        {% endfor %}
    </div>
</section>
{% endif %}

{% endblock %}

{% block extra_scripts %}
    <script src="{% static 'scripts/favoritos.js' %}"></script>
{% endblock %}