{% extends 'layout.html' %}
{% load static %}

{% block title %}{{ noticia.titulo }} | GENUS{% endblock %}

{% block extra_css %}
    <link rel="stylesheet" href="{% static 'styles/favoritos.css' %}">
    
    <link rel="stylesheet" href="{% static 'styles/ouvir_noticia.css' %}">
{% endblock %}

{% block content %}
<article class="noticia-detalhe">
    
    <h1 id="noticia-titulo">{{ noticia.titulo }}</h1>

    <div class="noticia-meta">
        <span>Por: <strong>{{ noticia.reporter }}</strong></span>
        <span>Publicado em: {{ noticia.data|date:"d/m/Y \à\s H:i" }}</span>
    </div>

    {% if noticia.imagem %}
        <div class="noticia-imagem-destaque" style="margin: 20px 0; text-align: center;">
            <img src="{{ noticia.imagem.url }}" alt="{{ noticia.titulo }}" style="max-width: 100%; height: auto; border-radius: 8px;">
        </div>
    {% endif %}

    <div class="corpo-noticia" id="noticia-corpo">
        {{ noticia.detalhes|linebreaks }}
    </div>

    <div class="noticia-acoes" style="margin-top: 20px;">
        
        <button 
            id="btn-ouvir-noticia" 
            class="noticia-card-link btn-ouvir"
        >
            Ouvir Notícia
        </button>
        
        {% if user.is_authenticated %}
            <button 
                id="btn-toggle-favorito"
                class="noticia-card-link btn-favorito {% if is_favorito %}favorito-ativo{% endif %}"
                data-noticia-id="{{ noticia.id }}"
                data-toggle-url="{% url 'jornal:toggle_favorito' noticia.id %}"
            >
                {% if is_favorito %}
                    Remover dos Favoritos
                {% else %}
                    Adicionar aos Favoritos
                {% endif %}
            </button>
            
        {% else %}
            <p>Faça login para adicionar aos favoritos.</p>
        {% endif %}
    </div>

</article>

{% if noticias_relacionadas %}
<section class="noticias-relacionadas">
    <h2 class="titulo-principal" style="margin-top: 40px;">Notícias Relacionadas</h2>
    
    <div class="favoritos-grid"> 
        {% for rel_noticia in noticias_relacionadas %}
        <article class="noticia-card">
            <h2 class="noticia-card-titulo">
                <a href="{% url 'jornal:pagina_noticias' rel_noticia.slug %}">{{ rel_noticia.titulo }}</a>
            </h2>
            <p class="noticia-card-resumo">{{ rel_noticia.resumo }}</p>
            <a href="{% url 'jornal:pagina_noticias' rel_noticia.slug %}" class="noticia-card-link">Leia mais</a>
        </article>
        {% endfor %}
    </div>
</section>
{% endif %}

{% endblock %}


{% block extra_scripts %}
    <script src="{% static 'scripts/favoritos.js' %}"></script>

    <script src="{% static 'scripts/ouvir_noticia.js' %}"></script>
{% endblock %}